System.register(["./vendor.js","./frameworks.js"],(function(e,t){"use strict";var n,s,a,o,i,r,c,l,u,d,m,p,f,g,j,h,b,v,w,y,L,k,T,M,A,E,H,S;return{setters:[function(e){n=e.a,s=e.g,a=e.b,o=e.o,i=e.c,r=e.r,c=e.d,l=e.q,u=e._,d=e.x,m=e.y},function(e){p=e.b,f=e.o,g=e.u,j=e.a,h=e.T,b=e.aa,v=e.bc,w=e.Q,y=e.r,L=e.bd,k=e.af,T=e.d,M=e.M,A=e.w,E=e.f,H=e.U,S=e.p}],execute:function(){n("details-menu-selected",".js-timeline-scoping-menu",(async function(e){const t=e.detail.relatedTarget,n=s(t,"data-url");let o;!function(e){const t=document.querySelector(".js-new-comment-form");if(!(t instanceof HTMLFormElement))return;const n=t.querySelector("input.js-scope-issue-timeline-input");if(!(n instanceof HTMLInputElement))return;n.value=e?"0":"1"}(t.hasAttribute("data-full-timeline"));try{o=await p(document,n)}catch(i){return}a(document,".js-issue-timeline-container").replaceWith(o)}),{capture:!0}),o(".js-issue-row .js-issues-list-check:checked",{add(e){i(e,".js-issue-row").classList.add("selected")},remove(e){i(e,".js-issue-row").classList.remove("selected")}}),n("navigation:keydown",".js-issue-row",(function(e){"x"===e.detail.hotkey&&(!function(e){const t=e.querySelector(".js-issues-list-check");t instanceof HTMLInputElement&&g(t,!t.checked)}(e.currentTarget),e.preventDefault(),e.stopPropagation())})),f("#js-issues-search",(function(e){const t=e;t.value=t.value}));const e=new WeakMap,q=new WeakMap;o(".js-milestone-issues",{subscribe:e=>j(e,"socket:message",(async function(e){const t=e.currentTarget,n=e.detail.data,o=a(t,".js-milestone-issues-container");if(q.has(o))return void q.delete(o);await h();const i=document.querySelector(".js-client-uid");i instanceof HTMLInputElement&&i.value===n.client_uid||async function(e){if(b(e))return;const t=s(e,"data-url"),n=await p(document,t);v(document,()=>{e.replaceWith(n)})}(t)}))}),r(".js-milestone-sort-form",(async function(e,t){const n=(await t.json()).json,s=a(e,".js-milestone-reorder-feedback");s.textContent="",n.error?a(e,".js-milestone-changed").classList.remove("d-none"):(a(e,".js-timestamp",HTMLInputElement).value=n.updated_at,s.textContent=s.getAttribute("data-success-text")||"")}));const x=c((function(e){const{newIndex:t,item:n}=e,s=i(n,".js-milestone-issues-container"),o=n.getAttribute("data-id")||"",r=function(e,t){return e.querySelectorAll(".js-draggable-issue")[t]}(s,t-1),c=r&&r.getAttribute("data-id"),l=i(s,".js-milestone-sort-form",HTMLFormElement);a(l,".js-item-id",HTMLInputElement).value=o,a(l,".js-prev-id",HTMLInputElement).value=c||"",w({category:"Milestone",action:"reorder",label:"string"==typeof e.trackingLabel?e.trackingLabel:"drag-and-drop"}),q.set(s,!0),y(l)}),200);function I(e,t){x({oldIndex:void 0,item:t,newIndex:Array.from(e.querySelectorAll(".js-draggable-issue")).indexOf(t),trackingLabel:"keyboard-shortcut"}),L(i(t,".js-navigation-container"),t)}function F(e){const t=e.currentTarget;if(!(t instanceof HTMLElement))return;const n=a(t,".js-milestone-edit-cancel"),s=n.getAttribute("data-confirm-changes");s&&(k(t)?n.setAttribute("data-confirm",s):n.removeAttribute("data-confirm"))}let P;n("click",".js-draggable-issue .js-sortable-button",(async function({currentTarget:e}){const{moveWithButton:n}=await t.import("./sortable-behavior.js");n(e,i(e,".js-draggable-issue"),x)})),n("navigation:keydown",".js-draggable-issues-container .js-draggable-issue",(function(e){const t=e.currentTarget,n=i(t,".js-draggable-issues-container");if("J"===e.detail.hotkey){const s=t.nextElementSibling;s&&(s.after(t),I(n,t),e.preventDefault(),e.stopPropagation())}else if("K"===e.detail.hotkey){const s=t.previousElementSibling;s&&(s.before(t),I(n,t),e.preventDefault(),e.stopPropagation())}})),o(".js-draggable-issues-container",{add:async function(n){if(e.has(n))return;const{Sortable:s}=await t.import("./sortable-behavior.js"),a=s.create(n,{animation:150,item:".js-draggable-issue",handle:".js-drag-handle",onUpdate:x,chosenClass:"is-dragging"});e.set(n,a)},remove:function(t){const n=e.get(t);n&&n.destroy()}}),n("change",".js-milestone-edit-form",F),n("click",".js-milestone-edit-form",F);let W=null;function C(e){const{item:t,oldIndex:n}=e;W=t.parentNode.children[n+1]}async function D(e){const{oldIndex:t,newIndex:n,item:s}=e;if(t===n)return;const o=i(s,".js-pinned-issues-reorder-form",HTMLFormElement),r=i(o,".js-pinned-issues-reorder-container"),c=a(r,".js-pinned-issues-spinner");c.style.display="inline-block",P.option("disabled",!0);try{await T(o.action,{method:o.method,body:new FormData(o)}),c.style.display="none",P.option("disabled",!1)}catch(l){const e=s.parentNode;W?e.insertBefore(s,W):e.appendChild(s)}}o(".js-pinned-issues-reorder-list",{async add(e){const{Sortable:n}=await t.import("./sortable-behavior.js");P=n.create(e,{animation:150,item:".js-pinned-issue-list-item",handle:".js-pinned-issue-reorder",onUpdate:D,onStart:C,chosenClass:"is-dragging"})}}),n("submit",".js-pinned-issues-reorder-form",(function(e){e.preventDefault()})),n("click",".js-pinned-issue-list-item .js-sortable-button",(async function({currentTarget:e}){const n=e,{moveWithButton:s}=await t.import("./sortable-behavior.js");s(n,i(n,".js-pinned-issue-list-item"),D)}));let $=null;const R=c((async function(){const e=a(document,".js-quick-pull-new-branch-name",HTMLInputElement),t=e.value,n=e.getAttribute("data-generated-branch"),o=a(document,".js-quick-pull-normalization-info"),i=new FormData;i.append("ref",t);const r=s(e,"data-check-url"),c=a(e.parentElement,".js-data-check-url-csrf",HTMLInputElement);null==$||$.abort();const{signal:l}=$=new AbortController;try{const s=await fetch(r,{mode:"same-origin",method:"POST",body:i,headers:{Accept:"application/json","Scoped-CSRF-Token":c.value,"X-Requested-With":"XMLHttpRequest"}});if(s.ok){const i=await s.json();if(t!==e.value)return;const r=i.normalized_ref;if(o.innerHTML=null==i.message_html?"":i.message_html,!r){a(o,"code").textContent=n}null}}catch(u){}l.aborted||e.value}),200);function O(){return document.querySelectorAll(".js-template-editor").length>0}function B(){return document.querySelectorAll(".js-template-form.is-loading").length>0?"loading":document.querySelectorAll(".js-template-form.is-errored").length>0?"error":"ok"}function X(){const e=a(document,".js-commit-templates-form",HTMLFormElement),t=a(e,".js-blob-submit",HTMLButtonElement),n=a(document,".js-template-commit-form-error-message"),s=a(document,".js-template-commit-form-loading-message");switch(B()){case"loading":n.classList.add("d-none"),s.classList.remove("d-none"),e.setAttribute("disabled","disabled"),t.setAttribute("disabled","disabled");break;case"error":n.classList.remove("d-none"),s.classList.add("d-none"),e.setAttribute("disabled","disabled"),t.setAttribute("disabled","disabled");break;default:n.classList.add("d-none"),s.classList.add("d-none"),e.removeAttribute("disabled"),t.removeAttribute("disabled")}}async function _(e){e.classList.add("is-loading"),X();const t=a(e,'[name="filename"]',HTMLInputElement).value,n={};for(const i of l(document,".js-template-form",HTMLFormElement)){const e=a(i,'[name="filename"]',HTMLInputElement).value;n[e]={};const t=new FormData(i);for(const[s,a]of t.entries())n[e][s]=a.toString()}const s=new FormData(e);s.append("current",t),s.append("templates",JSON.stringify(n));const o=await fetch(e.action,{method:"POST",body:s,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!o.ok)return;const r=await o.json(),c=A(document,r.html);i(e,".js-template-preview").replaceWith(c);const u=a(document,".js-hidden-template-fields"),d=u.querySelector(`[data-filename="${r.filename}"]`);if(d instanceof HTMLInputElement)d.value=r.markdown;else{const e=document.createElement("input");e.type="hidden",e.name=`templates[][${r.filename}]`,e.setAttribute("data-filename",r.filename),e.value=r.markdown,u.append(e)}e.classList.remove("is-loading"),X()}function N(){for(const e of l(document,".js-template-form",HTMLFormElement))_(e)}o(".js-template-form .js-issue-labels",{add(e){const t=e.closest(".js-issue-template-labels-container");if(!t)return;const n=a(t,".js-issue-template-labels",HTMLInputElement);n.value="";for(const s of e.children){const e=s.getAttribute("data-name");e&&!n.value.includes(e)&&(""===n.value?n.value=e:n.value=`${n.value}, ${e}`)}}}),o(".js-template-form .js-issue-assignees",{add(e){const t=e.closest(".js-issue-template-assignees-container"),n=a(t,".js-issue-template-assignees",HTMLInputElement);n.value="";for(const s of e.children){const e=s.querySelector("span");if(e){const t=e.getAttribute("data-assignee-name");t&&!n.value.includes(t)&&(""===n.value?n.value=t:n.value=`${n.value}, ${t}`)}}}}),n("change",".js-quick-pull-choice-option",(function(e){if(!O())return;const t=e.currentTarget;a(document,".js-quick-pull-new-branch-name").toggleAttribute("required","quick-pull"===t.value)})),M(".js-quick-pull-new-branch-name",(function(e){if(!O())return;const t=e.target.value;a(document,".js-quick-pull-target-branch",HTMLInputElement).value=t,t.length&&R()})),M(".js-synced-template-input",(function(e){const t=e.target,n=t.getAttribute("data-sync");if(!n)return;const s=i(t,".js-sync-container"),o=l(s,`[data-sync-with="${n}"]`),r=t.value;if(""!==r.trim()){for(const e of o)e.textContent=t.value;if("name"===n){a(s,".js-sync-filename",HTMLInputElement).value=`${r.replace(/[^\w]/g,"-")}.md`.toLowerCase()}}else for(const a of o){const e=a.getAttribute("data-sync-blank");e&&(a.innerHTML=`<span class="text-gray">${e}</span>`)}})),n("submit",".js-template-form",(function(e){e.preventDefault(),_(e.currentTarget)})),n("click",".js-toggle-template-commit",(function(){const e=a(document,".js-template-commit-pane");e.classList.toggle("d-none"),e.classList.contains("d-none")||N()})),n("submit",".js-commit-templates-form",(function(e){"ok"!==B()&&e.preventDefault(),X()})),n("click",".js-refresh-template-content",(async function(e){const t=e.currentTarget,n=i(t,".js-template-form"),s=a(n,".js-template-content-preview");s.innerHTML='<span class="text-gray">Loading preview...</span>';const o=a(n,".js-template-content-textarea",HTMLTextAreaElement).value,r=t.getAttribute("data-markdown-preview-url");if(!r)return;const c=a(t.parentElement,".js-data-markdown-preview-url-csrf",HTMLInputElement),l=new FormData;l.append("markdown",o);const u=await fetch(r,{mode:"same-origin",method:"POST",body:l,headers:{"Scoped-CSRF-Token":c.value,"X-Requested-With":"XMLHttpRequest"}});if(!u.ok)return;const d=await u.text();s.innerHTML=d})),n("click",".js-custom-template-toggle",e=>{const t=e.target,n=i(t,".js-template-preview"),s=!n.classList.contains("expand-preview");if(function(){const e=document.querySelectorAll(".js-template-preview");for(const t of e)t.classList.remove("expand-preview")}(),s)n.classList.add("expand-preview"),n.scrollIntoView({behavior:"smooth",block:"start"});else{_(a(n,".js-template-form",HTMLFormElement))}}),n("click",".js-remove-template-button",(function(e){const t=i(e.target,".js-template-preview"),n=s(t,"data-filename"),o=a(document,".js-hidden-template-fields"),r=a(document,".js-toggle-template-commit",HTMLButtonElement),c=o.querySelector(`[data-filename="${n}"]`);c&&c.remove(),r.disabled=!1,t.remove(),N()})),n("click",".js-edit-custom-field-header",(function(e){i(e.target,".js-custom-field-header").classList.toggle("section-focus"),a(document,".js-toggle-template-commit",HTMLButtonElement).disabled=!1})),n("details-menu-selected",".js-add-template",(function(e){const t=a(document,".js-templates-container"),n=a(document,".js-toggle-template-commit",HTMLButtonElement),s=e.detail.relatedTarget.value;if(!s)return;n.disabled=!1;const o=document.getElementById(s);t.append(o.content.cloneNode(!0))}),{capture:!0});const U=new WeakMap,z=new WeakMap;n("change",".js-issues-list-check",(function(){const e=!!document.querySelector(".js-issues-list-check:checked");a(document,"#js-issues-toolbar").classList.toggle("triage-mode",e);for(const t of document.querySelectorAll(".js-issue-triage-menu"))U.set(t,!0)})),n("toggle",".js-issue-triage-menu",(function(e){const t=e.currentTarget;t.hasAttribute("open")?function(e){if(!U.has(e))return;const t=a(document,".js-triage-loader-template",HTMLTemplateElement),n=a(e,".js-triage-deferred-content");n.innerHTML="",n.append(t.content.cloneNode(!0));const o=function(e,t){const n=new URL(e,window.location.origin),s=new URLSearchParams(n.search);for(const[a,o]of t)s.append(a,o);return n.search=s.toString(),n.toString()}(s(e,"data-url"),l(document,".js-issues-list-check:checked",HTMLInputElement).map(e=>[e.name,e.value]));a(n,"include-fragment").setAttribute("src",o),U.delete(e)}(t):async function(e){const t=a(e,"form",HTMLFormElement);if(!z.has(t))return;!function(e,t){const n=i(e,".js-issues-toolbar-triage");a(n,".js-issue-triage-spinner").hidden=!t,a(n,".js-issue-triage-error").hidden=!0}(e,!0);try{const e=await E(t.action,{method:t.method,body:new FormData(t)});z.delete(t),await H(e.job.url,{headers:{accept:"application/json"}}),S({url:window.location.href,container:a(document,"#js-repo-pjax-container"),replace:!0})}catch(n){!function(e,t){const n=i(e,".js-issues-toolbar-triage");a(n,".js-issue-triage-spinner").hidden=!0,a(n,".js-issue-triage-error").hidden=!t}(e,!0)}}(t)}),{capture:!0}),n("details-menu-selected",".js-issue-triage-menu details-menu",(function(e){const t=e.detail.relatedTarget,n=i(t,"form",HTMLFormElement),s=function(e){const t="true"===e.getAttribute("aria-checked"),n=e.getAttribute("name")||e.getAttribute("data-name"),s=e.getAttribute("value")||e.getAttribute("data-value"),a=document.createElement("input");switch(a.type="hidden",a.name=n,e.getAttribute("role")){case"menuitem":case"menuitemradio":a.value=s;break;case"menuitemcheckbox":a.value=t?s:"0"}return a}(t),o=a(n,".js-issues-triage-fields"),r=o.querySelector(`[name='${s.name}']`);r?r.replaceWith(s):o.append(s);z.set(n,!0)}),{capture:!0}),r(".js-undo-issue-event-form",async(e,t)=>{await t.text();const n=s(e,"action");e.remove();const a=document.querySelectorAll(`.js-undo-issue-event-form[action="${n}"]`);for(let s=0;s<a.length;s++)a[s].remove()});let J=class PagerFlowElement extends HTMLElement{constructor(){super(...arguments),this.currentPage=0}connectedCallback(){this.toggleTargets()}toggleTargets(){const e=this.currentPage+1>=this.pages.length;for(const t of this.hideOnLastPages)t.hidden=e;for(const t of this.showOnLastPages)t.hidden=!e}next(){this.pages[this.currentPage].hidden=!0,this.currentPage+=1,this.pages[this.currentPage].hidden=!1,this.toggleTargets()}};u([d],J.prototype,"hideOnLastPages",void 0),u([d],J.prototype,"showOnLastPages",void 0),u([d],J.prototype,"pages",void 0),J=u([m],J)}}}));
//# sourceMappingURL=issues-bootstrap-3f5b0e8f.js.map
